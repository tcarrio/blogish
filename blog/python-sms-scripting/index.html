<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
      
    

      <title></title>

      
        <link rel="alternate" type="application/atom+xml" title="RSS" href="https://blog.carrio.dev/atom.xml">
      

      
          <link rel="stylesheet" href="https://blog.carrio.dev/site.css">
      

      
      
    </head>

    <body class="hack dark main container">
        
    
        
                
                    <header>
                        <nav itemscope itemtype="http://schema.org/SiteNavigationElement">
                        
                            <a itemprop="url"
                               class=""
                               href="https://blog.carrio.dev">
                                <span itemprop="name">Home</span></a>
                        
                            <a itemprop="url"
                               class=""
                               href="https://blog.carrio.dev/blog">
                                <span itemprop="name">Blog</span></a>
                        
                            <a itemprop="url"
                               class=""
                               href="https://blog.carrio.dev/tags">
                                <span itemprop="name">Tags</span></a>
                        
                        </nav>
                    </header>
                
            
    

<article itemscope itemtype="http://schema.org/BlogPosting">
    <header>
        <h1 itemprop="headline">Python SMS scripting</h1>
        <span class="muted">
    <svg class="icon i-clock" viewBox="0 0 32 32"
         width="16" height="16" fill="none" stroke="currentcolor"
         stroke-linecap="round" stroke-linejoin="round" stroke-width="6.25%">
        <circle cx="16" cy="16" r="14"/>
        <path d="M16 8 L16 16 20 20"/>
    </svg>
    <span>4 minute read</span>
    <svg class="icon i-edit" viewBox="0 0 32 32"
         width="16" height="16" fill="none" stroke="currentcolor"
         stroke-linecap="round" stroke-linejoin="round" stroke-width="6.25%">
        <path d="M30 7 L25 2 5 22 3 29 10 27 Z M21 6 L26 11 Z M5 22 L10 27 Z"/>
    </svg>

    Published: 2015-06-11
</span>
    </header>
    <div itemprop="articleBody">
        <hr/>
        

<div class="toc">
Table of Contents:
    <ul>
    
        <li>
            <a href="https://blog.carrio.dev/blog/python-sms-scripting/#foreword-from-the-future-magic-hands">Foreword from the future :magic-hands:</a>
            
        </li>
    
        <li>
            <a href="https://blog.carrio.dev/blog/python-sms-scripting/#the-goal">The goal</a>
            
        </li>
    
        <li>
            <a href="https://blog.carrio.dev/blog/python-sms-scripting/#the-api">The API</a>
            
        </li>
    
        <li>
            <a href="https://blog.carrio.dev/blog/python-sms-scripting/#http-requests">HTTP requests</a>
            
        </li>
    
        <li>
            <a href="https://blog.carrio.dev/blog/python-sms-scripting/#coding-it-up">Coding it up</a>
            
                <ul>
                    
                        <li>
                            <a href="https://blog.carrio.dev/blog/python-sms-scripting/#api-credentials">API Credentials</a>
                        </li>
                    
                        <li>
                            <a href="https://blog.carrio.dev/blog/python-sms-scripting/#dependencies">Dependencies</a>
                        </li>
                    
                        <li>
                            <a href="https://blog.carrio.dev/blog/python-sms-scripting/#http-requests-1">HTTP Requests</a>
                        </li>
                    
                        <li>
                            <a href="https://blog.carrio.dev/blog/python-sms-scripting/#wrapping-it-all-up">Wrapping it all up</a>
                        </li>
                    
                        <li>
                            <a href="https://blog.carrio.dev/blog/python-sms-scripting/#documentation">Documentation!</a>
                        </li>
                    
                </ul>
            
        </li>
    
    </ul>
</div>


        <hr />
        <h2 id="foreword-from-the-future-magic-hands">Foreword from the future :magic-hands:</h2>
<p>This post is a simple summary of how you can accomplish SMS text messaging via web APIs. Services exist today like Twilio that are massively popular, but a decade ago these were not <em>as</em> stable or accessible. This post is based on source code from my <a href="https://github.com/tcarrio/py2sms"><strong>py2sms</strong> repository</a>, which showcased how you could do this. This was forked from another project that was based on another SMS API service.</p>
<h2 id="the-goal">The goal</h2>
<p>We're going to build a simple script showcasing how you can send text messages with Python. The service I'm going to utilize for this is <a href="https://eztexting.com">eztexting</a>. This will utilize a popular HTTP library and be implemented for Python 3.</p>
<h2 id="the-api">The API</h2>
<p>The API for sending SMS messages with <a href="https://eztexting.com">eztexting</a> allows you to POST data to an endpoint with your authentication info (username/password), a list of numbers, and the message content. The format is optional, and in this case we're going to prefer JSON since it's straightforward to define Python dictionaries and serialize them to JSON with the <code>json</code> package.</p>
<h2 id="http-requests">HTTP requests</h2>
<p>While Python has standard libraries for working with HTTP, they can feel <em>clunky</em> in regards to developer experience. You have to handle a lot of defaults and calls and objects to do this yourself. Due to this, I'm going to rely on [requests], a popular HTTP request library for Python. <strong>requests</strong> touts itself as &quot;HTTP for Humans. An elegant and simple HTTP library for Python, built for human beings.&quot; I would request this for anyone not doing low-level networking type of work with Python, and even then consider whether you really need to subject yourself to the world of <code>urllib`` and </code>http`.</p>
<h2 id="coding-it-up">Coding it up</h2>
<h3 id="api-credentials">API Credentials</h3>
<p>This is just a proof of concept, so in this solution I'm going to have a very basic approach to secrets management and the overall script safety. To start off, we're going to need a way to load credentials without embedding them in our version control. In my case, I define a <code>credentials</code> file which I configure <code>git</code> to ignore with a <code>.gitignore</code> entry:</p>
<pre style="background-color:#171c19;color:#87928a;"><code><span># .gitignore:
</span><span>/credentials
</span></code></pre>
<p>Now I can throw my username and password for eztexting in there</p>
<pre style="background-color:#171c19;color:#87928a;"><code><span># /credentials
</span><span>a_username
</span><span>def1n1t3lyMyP@ssword
</span></code></pre>
<h3 id="dependencies">Dependencies</h3>
<p>Now let's make sure we have our dependencies. In my case I'm using <code>requests</code>, <code>pprint</code>, and <code>json</code>. The first two need to be installed in your system. There are better ways to do this than global installs, like a virtualenv. You would run this inside there:</p>
<pre data-lang="bash" style="background-color:#171c19;color:#87928a;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#b16139;">pip</span><span> install requests pprint
</span></code></pre>
<p>And then you can import these with</p>
<pre data-lang="py" style="background-color:#171c19;color:#87928a;" class="language-py "><code class="language-py" data-lang="py"><span style="color:#55859b;">import </span><span>json
</span><span style="color:#55859b;">import </span><span>pprint
</span><span style="color:#55859b;">import </span><span>requests
</span></code></pre>
<h3 id="http-requests-1">HTTP Requests</h3>
<p>Next, we'll create an HTTP request with the necessary URL and body using my credentials:</p>
<pre data-lang="py" style="background-color:#171c19;color:#87928a;" class="language-py "><code class="language-py" data-lang="py"><span>cred = </span><span style="color:#1c9aa0;">open</span><span>(&#39;</span><span style="color:#489963;">credentials</span><span>&#39;, &#39;</span><span style="color:#489963;">r</span><span>&#39;).</span><span style="color:#b16139;">readlines</span><span>()
</span><span>addr = &quot;</span><span style="color:#489963;">https://app.eztexting.com/sending/messages?format=json</span><span>&quot;
</span><span>number = </span><span style="color:#b16139;">str</span><span>(pnumber)
</span><span>message= </span><span style="color:#b16139;">str</span><span>(msg)
</span><span>content = {
</span><span>    &#39;</span><span style="color:#489963;">User</span><span>&#39;: cred[</span><span style="color:#9f713c;">0</span><span>].</span><span style="color:#b16139;">strip</span><span>(), 
</span><span>    &#39;</span><span style="color:#489963;">Password</span><span>&#39;: cred[</span><span style="color:#9f713c;">1</span><span>].</span><span style="color:#b16139;">strip</span><span>(),
</span><span>    &#39;</span><span style="color:#489963;">PhoneNumbers[]</span><span>&#39;: &#39;</span><span style="color:#489963;">555-123-4567,</span><span style="background-color:#b16139;color:#ecf4ee;">
</span><span>    &#39;</span><span style="color:#489963;">Message</span><span>&#39;: &#39;</span><span style="color:#489963;">Hello world</span><span>&#39;
</span><span>}
</span><span>
</span><span>r = requests.</span><span style="color:#b16139;">post</span><span>(addr,</span><span style="color:#b16139;">data</span><span>=content)
</span></code></pre>
<p>This technically works as is, other than eztexting blowing up about the number. A successful response is going to be indicated with a 204, 'No Content', HTTP status code.</p>
<h3 id="wrapping-it-all-up">Wrapping it all up</h3>
<p>Let's check the status and log errors, and finally parameterize the logic so it can be called as a function by other modules. Here's the final code afterward:</p>
<pre data-lang="python" style="background-color:#171c19;color:#87928a;" class="language-python "><code class="language-python" data-lang="python"><span style="color:#5f6d64;">#  _____   __     __  ___     _____   __  __    _____ 
</span><span style="color:#5f6d64;"># |  __ \  \ \   / / |__ \   / ____| |  \/  |  / ____|
</span><span style="color:#5f6d64;"># | |__) |  \ \_/ /     ) | | (___   | \  / | | (___  
</span><span style="color:#5f6d64;"># |  ___/    \   /     / /   \___ \  | |\/| |  \___ \ 
</span><span style="color:#5f6d64;"># | |         | |     / /_   ____) | | |  | |  ____) |
</span><span style="color:#5f6d64;"># |_|         |_|    |____| |_____/  |_|  |_| |_____/ 
</span><span style="color:#5f6d64;">#                                                     
</span><span>
</span><span>
</span><span style="color:#55859b;">import </span><span>json
</span><span style="color:#55859b;">import </span><span>pprint
</span><span style="color:#55859b;">import </span><span>requests
</span><span style="color:#5f6d64;"># &#39;pip install requests&#39; to install this library
</span><span>
</span><span>
</span><span style="color:#55859b;">with </span><span style="color:#1c9aa0;">open</span><span>(&#39;</span><span style="color:#489963;">credentials</span><span>&#39;,&#39;</span><span style="color:#489963;">r</span><span>&#39;) </span><span style="color:#55859b;">as </span><span>c:
</span><span>		cred = c.</span><span style="color:#b16139;">readlines</span><span>()
</span><span>
</span><span style="color:#55859b;">def </span><span style="color:#478c90;">sms</span><span>(</span><span style="color:#b16139;">pnumber</span><span>,</span><span style="color:#b16139;">msg</span><span>):
</span><span>	addr = &quot;</span><span style="color:#489963;">https://app.eztexting.com/sending/messages?format=json</span><span>&quot;
</span><span>	number = </span><span style="color:#b16139;">str</span><span>(pnumber)
</span><span>	message= </span><span style="color:#b16139;">str</span><span>(msg)
</span><span>	content = {
</span><span>		&#39;</span><span style="color:#489963;">User</span><span>&#39;: cred[</span><span style="color:#9f713c;">0</span><span>].</span><span style="color:#b16139;">strip</span><span>(), 
</span><span>		&#39;</span><span style="color:#489963;">Password</span><span>&#39;: cred[</span><span style="color:#9f713c;">1</span><span>].</span><span style="color:#b16139;">strip</span><span>(),
</span><span>		&#39;</span><span style="color:#489963;">PhoneNumbers[]</span><span>&#39;: number,
</span><span>		&#39;</span><span style="color:#489963;">Message</span><span>&#39;: message}
</span><span>	pprint.</span><span style="color:#b16139;">pprint</span><span>(content)
</span><span>	r = requests.</span><span style="color:#b16139;">post</span><span>(addr,</span><span style="color:#b16139;">data</span><span>=content)
</span><span>	</span><span style="color:#55859b;">if </span><span>r.status_code != </span><span style="color:#9f713c;">204</span><span>:
</span><span>		pprint.</span><span style="color:#b16139;">pprint</span><span>(r.</span><span style="color:#b16139;">json</span><span>())
</span><span>	</span><span style="color:#55859b;">else</span><span>:
</span><span>		</span><span style="color:#1c9aa0;">print</span><span>(&quot;</span><span style="color:#489963;">Status code 204: No content returned</span><span>&quot;)
</span><span>
</span><span style="color:#5f6d64;"># To send a text message call the function with
</span><span style="color:#5f6d64;"># sms(phonenumber,&#39;sending this text message&#39;)
</span><span style="color:#5f6d64;"># sms(5551235555,&#39;Hello World!&#39;)
</span></code></pre>
<h3 id="documentation">Documentation!</h3>
<p>A project can always use a README. It helps people get started in your codebase and understand further context behind decisions, design, and more. </p>
<pre data-lang="md" style="background-color:#171c19;color:#87928a;" class="language-md "><code class="language-md" data-lang="md"><span style="color:#478c90;"># About
</span><span>
</span><span>Fork of the py2sms project which was based off the &lt;</span><span style="color:#b16139;">b</span><span>&gt;textbelt&lt;/</span><span style="color:#b16139;">b</span><span>&gt; service.
</span><span>
</span><span>Due to limited functionality and inconsistent service, this implementation will utilize the &lt;</span><span style="color:#b16139;">b</span><span>&gt;eztexting&lt;/</span><span style="color:#b16139;">b</span><span>&gt; service instead.
</span><span>
</span><span style="color:#478c90;"># How To Use
</span><span>
</span><span>You will need to create a &lt;</span><span style="color:#b16139;">b</span><span>&gt;free&lt;/</span><span style="color:#b16139;">b</span><span>&gt; account at &lt;</span><span style="color:#b16139;">a </span><span style="color:#9f713c;">href</span><span>=&quot;</span><span style="color:#489963;">https://www.eztexting.com/start?pid=free</span><span>&quot;&gt;eztexting.com&lt;/</span><span style="color:#b16139;">a</span><span>&gt;, and add your username/password to the credentials file.
</span><span>
</span><span>The script pulls this info to make requests to the RESTful API. 
</span><span>
</span><span>You are alotted a total of 500 messages per month with this service. 
</span><span>
</span><span style="color:#478c90;"># API Documentation
</span><span>
</span><span>https://www.eztexting.com/developers/sms-api-documentation/rest
</span></code></pre>
<!-- References -->

    </div>

    
        <footer>
            <hr>
            <p>
                
                    Published by Tom Carrio
                
                
                
                    
                    tagged
                    
                        <a href="https://blog.carrio.dev/tags/sms/">sms</a>
                        
                            
                                
                                    ,
                                
                            
                        
                    
                        <a href="https://blog.carrio.dev/tags/python/">python</a>
                        
                            
                                
                                    ,
                                
                            
                        
                    
                        <a href="https://blog.carrio.dev/tags/scripting/">scripting</a>
                        
                            
                                
                                    and
                                
                            
                        
                    
                        <a href="https://blog.carrio.dev/tags/requests/">requests</a>
                        
                            
                        
                    
                
            </p>
            
            
        </footer>
    
</article>


    </body>

</html>
